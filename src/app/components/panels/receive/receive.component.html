<div *transloco="let t">
	<div
		class="uk-animation-slide-left-small"
		uk-grid
	>
		<div class="uk-width-1-1">
			<ng-template #switchToMerchantModeButton>
				<button
					class="uk-width-1-1 uk-width-auto@s uk-button uk-button-primary uk-text-center nlt-icon-button nlt-button-green"
					type="button"
					(click)="merchantModeEnable()"
				>
					<span
						class="nlt-icon"
						uk-icon="icon: cart;"
					></span>
					<span class="merchant-mode-text-full">Switch to Merchant Mode</span>
					<span class="merchant-mode-text-short">Merchant Mode</span>
				</button>
			</ng-template>
			<ng-template #copyPaymentUriButton>
				@if (receivableAccountModel !== '0' && qrAmount != null) {
					<button
						class="uk-width-1-1 uk-width-5-6@s uk-button uk-button-primary uk-text-center nlt-icon-button"
						[class.nlt-button-success]="recentlyCopiedPaymentUri"
						[class.uk-disabled]="recentlyCopiedPaymentUri"
						type="button"
						ngxClipboard
						[cbContent]="qrCodeUri"
						(cbOnSuccess)="copiedPaymentUri()"
					>
						<span
							class="nlt-icon"
							uk-icon="icon: copy;"
						></span>
						{{ recentlyCopiedPaymentUri ? 'Copied!' : 'Copy payment link' }}
					</button>
				}
			</ng-template>
			<ng-template #copyPaymentAddressButton>
				@if (receivableAccountModel !== '0') {
					<button
						class="uk-width-1-1 uk-width-5-6@s uk-button uk-text-center nlt-icon-button"
						[class.uk-button-primary]="recentlyCopiedAccountAddress || qrAmount == null"
						[class.uk-button-secondary]="!recentlyCopiedAccountAddress && qrAmount != null"
						[class.nlt-button-success]="recentlyCopiedAccountAddress"
						[class.uk-disabled]="recentlyCopiedAccountAddress"
						type="button"
						ngxClipboard
						[cbContent]="receivableAccountModel"
						(cbOnSuccess)="copiedAccountAddress()"
					>
						<span
							class="nlt-icon"
							uk-icon="icon: copy;"
						></span>
						{{ recentlyCopiedAccountAddress ? 'Copied!' : 'Copy address' }}
					</button>
				}
			</ng-template>
			<div class="uk-margin-bottom uk-flex uk-flex-between">
				<h2 class="uk-flex-1 uk-heading-divider uk-margin-remove">{{ t('receive.receive-nano') }}</h2>
				<div class="uk-flex-none uk-visible@s uk-flex uk-flex-top uk-margin-medium-left">
					<ng-container *ngTemplateOutlet="switchToMerchantModeButton"></ng-container>
				</div>
			</div>
			<div class="uk-card uk-card-default uk-margin">
				<div class="uk-card-body">
					<div class="uk-form-horizontal receive-columns">
						<div class="uk-flex-1">
							<div class="uk-margin">
								<label
									for="form-horizontal-select-account"
									class="uk-form-label label-block"
									>{{ t('general.account') }}</label
								>
								<div class="form-account">
									<select
										id="form-horizontal-select-account"
										class="uk-select"
										[(ngModel)]="receivableAccountModel"
										(change)="onSelectedAccountChange(receivableAccountModel)"
									>
										<option [value]="0">{{ t('receive.all-accounts') }}</option>
										@for (account of accounts; track account) {
											<option [value]="account.address">
												{{ account.addressBookName ? account.addressBookName + ' - ' : '#' + account.index + ' - ' }}
												{{ account.address | squeeze }} ({{ account.balance | rai: 'mnano,true' | amountsplit: 0
												}}{{ account.balance | rai: 'mnano,true' | amountsplit: 1 }} XNO)
											</option>
										}
									</select>
								</div>
							</div>
							<div class="uk-margin">
								<label
									for="form-horizontal-amount"
									class="uk-form-label label-block"
								>
									{{ t('receive.requested-amount') }}
									<span class="uk-text-muted label-optional"> {{ t('general.optional') }} </span>
								</label>
								<div class="form-amount">
									<div class="uk-width-1-1 uk-inline">
										<label
											class="uk-form-icon uk-link-reset uk-link-muted"
											for="form-horizontal-amount"
											>&#xe001;</label
										>
										<input
											[(ngModel)]="amountNano"
											[ngClass]="{ 'uk-form-danger': !validNano }"
											[attr.disabled]="receivableAccountModel == '0' || null"
											autocomplete="off"
											class="uk-input"
											id="form-horizontal-amount"
											(input)="nanoAmountChange()"
											style="padding-left: 52px !important"
											type="number"
											step="any"
											[placeholder]="t('receive.amount-of-x', { currency: 'XNO' })"
											maxlength="40"
										/>
									</div>
									@if (displayCurrency) {
										<div style="margin-top: 10px">
											<div class="uk-width-1-1 uk-inline">
												<a
													class="uk-form-icon uk-link-reset uk-link-muted fiat-currency-ticker"
													uk-tooltip
													title="Last Price: {{ svcPrice.lastPrice() }} / XNO"
													>{{ displayCurrency | currencySymbol }}</a
												>
												<input
													[(ngModel)]="amountFiat"
													[ngClass]="{ 'uk-form-danger': !validFiat }"
													[attr.disabled]="receivableAccountModel == '0' || null"
													autocomplete="off"
													(input)="fiatAmountChange()"
													style="padding-left: 52px !important"
													class="uk-input"
													id="form-horizontal-text-fiat"
													type="number"
													step="any"
													[placeholder]="t('receive.amount-of-x', { currency: displayCurrency })"
												/>
											</div>
										</div>
									}
								</div>
							</div>
							<div
								class="uk-margin uk-margin-medium-top uk-visible@s uk-flex uk-flex-column"
								style="width: 320px"
							>
								<div
									class="uk-width-1-1 uk-flex"
									[style]="qrAmount != null ? 'margin-bottom: 20px;' : ''"
								>
									<ng-container *ngTemplateOutlet="copyPaymentUriButton"></ng-container>
								</div>
								<div class="uk-width-1-1 uk-flex">
									<ng-container *ngTemplateOutlet="copyPaymentAddressButton"></ng-container>
								</div>
							</div>
						</div>
						<div class="uk-flex-1 qr-column">
							@if (qrCodeImage) {
								<div>
									<div class="qr-code">
										<img
											class="uk-position-absolute"
											[src]="qrCodeImage"
											alt="QR code"
										/>
										<div
											class="qr-confirmation"
											[class]="qrSuccessClass"
										>
											<div uk-icon="icon: check; ratio: 5"></div>
											<span class="uk-text-large uk-text-center">{{ t('receive.nano-received') }}</span>
										</div>
										<div style="padding-top: 100%"></div>
									</div>
								</div>
							} @else {
								<div class="qr-code qr-placeholder">
									@if (receivableAccountModel === '0') {
										<div
											class="uk-position-absolute text-half-muted"
											style="width: 50%"
										>
											{{ t('receive.select-an-account-to-view-qr-code') }}
										</div>
									}
									@if (receivableAccountModel !== '0') {
										<div class="uk-position-absolute text-half-muted">
											<div uk-spinner="ratio: 3;"></div>
										</div>
									}
									<div style="padding-top: 100%"></div>
								</div>
							}
							<div>
								@if (receivableAccountModel !== '0') {
									<div class="uk-flex uk-flex-center uk-flex-middle uk-text-center qr-address">
										<app-nano-account-id
											[address]="receivableAccountModel"
											middle="break"
											class="nano-address-monospace uk-width-auto"
											style="max-width: 90%"
										></app-nano-account-id>
									</div>
								}
								<div class="uk-margin-medium-top uk-hidden@s nlt-button-group uk-flex uk-flex-column uk-flex-middle">
									<ng-container *ngTemplateOutlet="copyPaymentUriButton"></ng-container>
									<ng-container *ngTemplateOutlet="copyPaymentAddressButton"></ng-container>
									<ng-container *ngTemplateOutlet="switchToMerchantModeButton"></ng-container>
								</div>
							</div>
						</div>
					</div>
				</div>
			</div>
			<div class="transactions-list-header uk-width-1-1 uk-flex uk-flex-center uk-flex-middle uk-margin-small-bottom">
				<h3 class="uk-margin-remove-bottom">{{ t('receive.incoming-transactions') }}</h3>
				<ul
					class="uk-width-auto uk-iconnav uk-margin-remove-left"
					style="margin-top: -1px"
				>
					<li>
						@if (loadingIncomingTxList) {
							<div
								uk-spinner="ratio: 0.5;"
								class="icon-transactions-refresh spinner"
							></div>
						} @else {
							<a
								uk-icon="icon: refresh;"
								class="icon-transactions-refresh"
								(click)="getReceivable()"
								uk-tooltip
								[title]="t('general.reload')"
							></a>
						}
					</li>
				</ul>
			</div>
			<div uk-grid>
				<div class="uk-width-1-1">
					<div class="transactions-list-mobile only-on-small-viewports">
						@if (receivableAccountModel !== '0') {
							<div class="date-header text-half-muted">{{ selectedAccountAddressBookName }}</div>
						}
						@for (transaction of receivableBlocksForSelectedAccount; track transaction; let transactionIdx = $index) {
							@if (
								receivableAccountModel === '0' &&
								(receivableBlocksForSelectedAccount[transactionIdx - 1] == null ||
									transaction.destinationAddressBookName !==
										receivableBlocksForSelectedAccount[transactionIdx - 1].destinationAddressBookName)
							) {
								<div class="date-header text-half-muted">{{ transaction.destinationAddressBookName }}</div>
							}
							<app-nano-transaction-mobile
								[transaction]="transaction"
								[settingIdenticonsStyle]="identiconsStyle"
								(click)="showMobileMenuForTransaction(transaction)"
							></app-nano-transaction-mobile>
						}
						@if (!loadingIncomingTxList && !receivableBlocksForSelectedAccount.length) {
							<div class="rounded-area">
								<div style="text-align: center">
									{{
										receivableAccountModel === '0'
											? 'No new incoming transactions'
											: 'No new incoming transactions for selected account'
									}}
								</div>
							</div>
						}
						@if (loadingIncomingTxList) {
							<div class="rounded-area">
								<div style="text-align: center">
									<span
										class="uk-margin-right"
										uk-spinner
									></span>
									{{ t('account-details.loading-incoming-transactions') }}
								</div>
							</div>
						}
					</div>
					<table
						class="transactions-list hide-on-small-viewports uk-table uk-table-striped uk-table-small"
						style="margin-top: 0"
					>
						<thead>
							<tr>
								<th
									scope="col"
									class="type-column"
								></th>
								<th
									scope="col"
									class="account-column"
								>
									{{ t('general.account') }} / {{ t('general.block') }}
								</th>
								<th
									scope="col"
									class="amount-column"
								>
									{{ t('general.amount') }}
								</th>
								<th
									scope="col"
									class="date-column"
								>
									{{ t('general.actions') }}
								</th>
							</tr>
						</thead>
						<tbody>
							@for (receivable of receivableBlocksForSelectedAccount; track receivable) {
								<tr [class]="{ 'uk-text-muted': true }">
									<td class="type-column">
										<span
											class="type uk-text-small"
											uk-icon="icon: plus-circle; ratio: 1.2;"
										></span>
									</td>
									<td class="account-column uk-visible-toggle uk-text-truncate">
										<div
											uk-grid
											class="uk-flex-nowrap"
										>
											<div
												class="uk-width-auto uk-text-truncate"
												style="max-width: calc(100% - 35px)"
											>
												<a
													[routerLink]="'/accounts/' + receivable.account"
													class="account-container uk-text-truncate"
													[title]="t('general.view-details')"
													uk-tooltip
												>
													<div class="identicon-name-row uk-text-truncate">
														@if (identiconsStyle !== 'none') {
															<app-nano-identicon
																scale="6"
																[address]="receivable.account"
																[settingIdenticonsStyle]="identiconsStyle"
																class="nano-identicon"
															></app-nano-identicon>
														}
														@if (receivable.addressBookName) {
															<div class="account-label uk-text-truncate">{{ receivable.addressBookName }}</div>
														}
													</div>
													<div class="nano-address-clickable nano-address-monospace uk-text-truncate">
														<app-nano-account-id
															[address]="receivable.account"
															middle="auto"
														></app-nano-account-id>
													</div>
												</a>
											</div>
											<div class="nano-address-actions uk-width-auto uk-flex uk-flex-bottom">
												<ul class="uk-iconnav">
													<li>
														<a
															ngxClipboard
															[cbContent]="receivable.account"
															(cbOnSuccess)="copied()"
															uk-icon="icon: copy"
															[title]="t('general.copy-to-clipboard')"
															uk-tooltip
														></a>
													</li>
												</ul>
											</div>
										</div>
										<a
											[routerLink]="'/transaction/' + receivable.hash"
											class="uk-link-text uk-text-small uk-text-muted uk-text-truncate block-hash block-hash-monospace"
											title="View Block Details"
											uk-tooltip
											>{{ receivable.hash }}</a
										>
										@if (receivableAccountModel === '0') {
											<div class="arrow-down">
												<div
													class="icon"
													uk-icon="icon: chevron-down; ratio: 1.2;"
												></div>
											</div>
											<div
												uk-grid
												class="uk-flex-nowrap"
											>
												<div
													class="uk-width-auto uk-text-truncate"
													style="max-width: calc(100% - 35px)"
												>
													<a
														[routerLink]="'/accounts/' + receivable.destination"
														class="account-container uk-text-truncate"
														[title]="t('general.view-details')"
														uk-tooltip
													>
														<div class="identicon-name-row uk-text-truncate">
															@if (identiconsStyle !== 'none') {
																<app-nano-identicon
																	scale="6"
																	[address]="receivable.destination"
																	[settingIdenticonsStyle]="identiconsStyle"
																	class="nano-identicon"
																></app-nano-identicon>
															}
															@if (receivable.destinationAddressBookName) {
																<div class="account-label uk-text-truncate">
																	{{ receivable.destinationAddressBookName }}
																</div>
															}
														</div>
														<div class="nano-address-clickable nano-address-monospace uk-text-truncate">
															<app-nano-account-id
																[address]="receivable.destination"
																middle="auto"
															></app-nano-account-id>
														</div>
													</a>
												</div>
												<div class="nano-address-actions uk-width-auto uk-flex uk-flex-bottom">
													<ul class="uk-iconnav">
														<li>
															<a
																ngxClipboard
																[cbContent]="receivable.destination"
																(cbOnSuccess)="copied()"
																uk-icon="icon: copy"
																[title]="t('general.copy-to-clipboard')"
																uk-tooltip
															></a>
														</li>
													</ul>
												</div>
											</div>
										}
									</td>
									<ng-template #transactionActions>
										<div class="button-container">
											@if (!receivable.loading) {
												<button
													class="uk-button uk-button-primary uk-text-center uk-width-auto"
													type="button"
													(click)="receiveReceivableBlock(receivable)"
												>
													{{ t('general.receive') | uppercase }}
												</button>
											}
											@if (receivable.loading) {
												<button
													class="uk-button uk-button-secondary uk-disabled uk-button-small nlt-icon-button nlt-icon-button-inline"
												>
													<span
														class="spinner"
														uk-spinner="ratio: 0.5;"
													></span>
													{{ t('receive.receiving') }}
												</button>
											}
										</div>
									</ng-template>
									<td
										class="amount-column uk-text-middle uk-text-muted"
										[title]="
											'Incoming Transaction' +
											(receivable.amountRaw && receivable.amountRaw > 0
												? ', +' + receivable.amountRaw.toString(10) + ' raw'
												: '')
										"
									>
										<span class="uk-text-small">{{ t('general.blockactions.ready-to-receive') }}</span
										><br />
										<span class="amount-integer">{{ receivable.amount | rai: 'mnano,true' | amountsplit: 0 }}</span>
										<span class="amount-fractional">{{ receivable.amount | rai: 'mnano,true' | amountsplit: 1 }}</span>
										<span class="currency-name">XNO</span>
										<div class="compact-actions-date">
											<ng-template [ngTemplateOutlet]="transactionActions"></ng-template>
										</div>
									</td>
									<td class="date-column uk-text-middle uk-text-truncate">
										<ng-template [ngTemplateOutlet]="transactionActions"></ng-template>
									</td>
								</tr>
							}
							@if (!loadingIncomingTxList && !receivableBlocksForSelectedAccount.length) {
								<tr>
									<td
										colspan="4"
										style="text-align: center"
									>
										{{
											receivableAccountModel === '0'
												? 'No new incoming transactions'
												: 'No new incoming transactions for selected account'
										}}
									</td>
								</tr>
							}
							@if (loadingIncomingTxList) {
								<tr>
									<td
										colspan="4"
										style="text-align: center"
									>
										<span
											class="uk-margin-right"
											uk-spinner
										></span>
										{{ t('account-details.loading-incoming-transactions') }}
									</td>
								</tr>
							}
						</tbody>
					</table>
					@if (minimumReceive) {
						<table class="uk-table uk-table-striped uk-table-small">
							<thead>
								<tr class="uk-alert uk-alert-primary missing-accounts-hint">
									<td
										colspan="4"
										style="text-align: center"
									>
										<span uk-icon="icon: info"></span>
										{{ t('receive.minimum-receive-is-set-to.1') }}
										@if (svcUtil.nano.mnanoToRaw(this.minimumReceive).length > 24) {
											<a
												class="hint-action"
												routerLink="/configure-app"
												routerLinkActive="active"
											>
												{{ svcUtil.nano.mnanoToRaw(this.minimumReceive) | rai: 'mnano,true' | amountsplit: 0
												}}{{ svcUtil.nano.mnanoToRaw(this.minimumReceive) | rai: 'mnano,false' | amountsplit: 1 }}
											</a>
										} @else {
											<a
												class="hint-action"
												routerLink="/configure-app"
												routerLinkActive="active"
											>
												{{ this.minimumReceive | rai: 'raw,false' }}
											</a>
										}
										{{ t('receive.minimum-receive-is-set-to.2') }}
									</td>
								</tr>
							</thead>
						</table>
					}
				</div>
			</div>
		</div>
	</div>
	<div
		class="modal-position-bottom"
		id="mobile-transaction-menu-modal"
		uk-modal
	>
		<div class="uk-modal-dialog">
			<div class="uk-modal-body">
				<div class="transactions-list-mobile">
					@if (mobileTransactionData) {
						<app-nano-transaction-mobile
							[isInteractable]="false"
							[transaction]="mobileTransactionData"
							[settingIdenticonsStyle]="identiconsStyle"
						></app-nano-transaction-mobile>
					}
				</div>
				@if (mobileTransactionData) {
					<div class="uk-width-1-1">
						<hr />
						<div
							class="menu-option uk-text-success"
							(click)="onReceiveFundsPress(mobileTransactionData)"
						>
							@if (!mobileTransactionData.received) {
								<span
									class="icon icon-download"
									uk-icon="icon: download; ratio: 1.5;"
									style="vertical-align: 2px"
								></span>
							}
							@if (!mobileTransactionData.received && !mobileTransactionData.loading) {
								<span>{{ t('receive.receive-nano') }}</span>
							}
							@if (!mobileTransactionData.received && mobileTransactionData.loading) {
								<span>{{ t('receive.receiving') }}</span>
							}
							@if (mobileTransactionData.received) {
								<span
									class="icon"
									uk-icon="icon: check; ratio: 1.3;"
									style="vertical-align: 2px"
								></span>
							}
							@if (mobileTransactionData.received) {
								<span>{{ t('receive.received') }}</span>
							}
						</div>
						<div
							class="menu-option"
							[routerLink]="'/transaction/' + mobileTransactionData.hash"
							(click)="mobileTransactionMenuModal.hide()"
						>
							<span
								class="icon"
								uk-icon="icon: search; ratio: 1.3;"
								style="vertical-align: 2px"
							></span>
							<span>{{ t('account-details.view-transaction-details') }}</span>
						</div>
					</div>
				}
			</div>
		</div>
	</div>
	<div
		class="merchant-mode-overlay"
		id="merchant-mode-modal"
		uk-modal
	>
		<div class="merchant-mode-contents uk-flex uk-flex-column uk-flex-middle">
			<div
				class="uk-width-1-1 merchant-mode-header"
				[class.uk-margin-medium-bottom]="inMerchantModeQR === false"
				[class.uk-margin-bottom]="inMerchantModeQR === true"
			>
				<div class="merchant-mode-logo"></div>
				<div
					class="merchant-mode-exit uk-flex uk-flex-middle"
					[class.uk-visible@s]="inMerchantModeQR === true"
					(click)="inMerchantModeQR ? merchantModeHideQR() : merchantModeDisable()"
				>
					<span
						uk-icon="icon: close; ratio: 1.4;"
						class="uk-margin-small-right"
						style="margin-top: 2px"
					></span>
					<span class="label">{{ inMerchantModeQR ? 'Cancel Payment' : 'Exit Merchant Mode' }}</span>
				</div>
			</div>
			<div
				class="merchant-centered-container uk-flex-1 uk-width-1-1 uk-flex uk-flex-column uk-flex-center uk-flex-middle uk-text-center"
			>
				@if (inMerchantModePaymentComplete === false && inMerchantModeQR === false && receivableAccountModel === '0') {
					<div class="uk-width-1-1 uk-card uk-card-default uk-margin-bottom">
						<div class="uk-card-body">
							<p class="uk-text-large">Select the <span class="uk-text-primary">destination account</span></p>
							<select
								id="form-horizontal-select-destination-account"
								class="uk-select"
								[(ngModel)]="receivableAccountModel"
								(change)="onSelectedAccountChange(receivableAccountModel)"
							>
								<option [value]="0">–</option>
								@for (account of accounts; track account) {
									<option [value]="account.address">
										{{ account.addressBookName ? account.addressBookName + ' - ' : '#' + account.index + ' - ' }}
										{{ account.address | squeeze }}
									</option>
								}
							</select>
						</div>
					</div>
				}
				@if (inMerchantModePaymentComplete === false && inMerchantModeQR === false && receivableAccountModel !== '0') {
					<div class="identicon-name-row uk-text-truncate">
						@if (identiconsStyle !== 'none') {
							<app-nano-identicon
								scale="6"
								[address]="receivableAccountModel"
								[settingIdenticonsStyle]="identiconsStyle"
								class="nano-identicon"
							></app-nano-identicon>
						}
						<div class="account-label uk-text-truncate">{{ selectedAccountAddressBookName }}</div>
					</div>
					<app-nano-account-id
						[address]="receivableAccountModel"
						middle="off"
						class="nano-address-monospace uk-width-auto"
					></app-nano-account-id>
					<button
						class="uk-width-auto uk-button uk-button-secondary uk-text-center nlt-icon-button uk-margin-small-top"
						type="button"
						(click)="unsetSelectedAccount()"
					>
						<span
							class="nlt-icon"
							uk-icon="icon: pencil;"
						></span>
						Change account
					</button>
					<div
						class="uk-width-1-1 uk-card uk-card-default uk-margin-bottom"
						style="margin-top: 60px"
					>
						<div class="uk-card-body">
							<p class="uk-text-large">Enter the <span class="uk-text-primary">requested amount</span></p>
							<div class="form-amount">
								<div class="uk-width-1-1 uk-inline">
									<label
										class="uk-form-icon uk-link-reset uk-link-muted"
										for="form-horizontal-amount"
										>&#xe001;</label
									>
									<input
										[(ngModel)]="amountNano"
										[ngClass]="{ 'uk-form-danger': !validNano }"
										[attr.disabled]="receivableAccountModel == '0' || null"
										autocomplete="off"
										class="uk-input"
										id="form-horizontal-amount"
										(input)="nanoAmountChange()"
										style="padding-left: 52px !important"
										type="number"
										step="any"
										placeholder="Amount of XNO"
										maxlength="40"
									/>
								</div>
								@if (displayCurrency) {
									<div style="margin-top: 10px">
										<p
											class="text-half-muted"
											style="margin: 0 0 14px 0"
										>
											or
										</p>
										<div class="uk-width-1-1 uk-inline">
											<a
												class="uk-form-icon uk-link-reset uk-link-muted fiat-currency-ticker"
												uk-tooltip
												title="Last Price: {{ svcPrice.lastPrice() }} / XNO"
												>{{ displayCurrency | currencySymbol }}</a
											>
											<input
												[(ngModel)]="amountFiat"
												[ngClass]="{ 'uk-form-danger': !validFiat }"
												[attr.disabled]="receivableAccountModel == '0' || null"
												autocomplete="off"
												(input)="fiatAmountChange()"
												style="padding-left: 52px !important"
												class="uk-input"
												id="form-horizontal-text-fiat"
												type="number"
												step="any"
												placeholder="Amount of {{ displayCurrency }}"
											/>
										</div>
									</div>
								}
							</div>
							<button
								class="uk-width-1-1 uk-button uk-button-primary uk-text-center nlt-icon-button uk-margin-medium-top"
								type="button"
								(click)="merchantModeShowQR()"
							>
								<span class="merchant-mode-icon-qr-code"></span> Create QR code
							</button>
						</div>
					</div>
				}
				@if (inMerchantModeQR === true) {
					<p class="uk-text-large uk-margin-remove-bottom">Send</p>
					@if (amountNano === '') {
						<p class="uk-text-large uk-text-primary uk-margin-remove-top">
							<span class="merchant-mode-currency-name">XNO</span>
						</p>
					}
					@if (amountNano !== '') {
						<p class="uk-text-large uk-text-primary uk-margin-remove-top">
							<span class="merchant-mode-amount-integer">{{
								merchantModeRawRequestedQR | rai: 'mnano,true' | amountsplit: 0
							}}</span>
							<span class="merchant-mode-amount-fractional">{{
								merchantModeRawRequestedQR | rai: 'mnano,true' | amountsplit: 1
							}}</span>
							<span class="merchant-mode-currency-name merchant-mode-currency-margin">XNO</span>
						</p>
					}
					<p
						class="text-half-muted"
						style="margin: -16px 0 10px 0"
					>
						to
					</p>
					<app-nano-account-id
						[address]="receivableAccountModel"
						middle="break"
						class="nano-address-monospace uk-width-auto"
						style="display: inline-block; max-width: 325px"
					></app-nano-account-id>
					<div
						class="uk-width-1-1 uk-flex uk-flex-center uk-margin-top"
						style="margin-bottom: 40px"
					>
						@if (qrCodeImage) {
							<img
								class="merchant-mode-qr-code"
								[src]="qrCodeImage"
								alt="QR code"
							/>
						}
						@if (!qrCodeImage) {
							<div class="merchant-mode-qr-code">
								<div uk-spinner="ratio: 2;"></div>
							</div>
						}
					</div>
					@for (prompt of merchantModePrompts; track prompt; let promptIdx = $index) {
						<div class="uk-width-1-1 uk-card uk-card-default uk-margin-bottom">
							<div class="uk-card-body">
								@if (amountNano === '') {
									<p class="uk-text-large text-half-muted uk-margin-remove-bottom">Received</p>
								}
								@if (amountNano !== '' && prompt.moreThanRequested) {
									<p class="uk-text-large text-half-muted uk-margin-remove-bottom">
										Received <span class="uk-text-success">more</span> than requested
									</p>
								}
								@if (amountNano !== '' && prompt.lessThanRequested) {
									<p class="uk-text-large text-half-muted uk-margin-remove-bottom">
										Received <span class="uk-text-warning">less</span> than requested
									</p>
								}
								<p
									class="uk-text-large uk-margin-remove-top"
									[class.uk-text-success]="prompt.moreThanRequested"
									[class.uk-text-warning]="prompt.lessThanRequested"
								>
									<span class="merchant-mode-amount-integer">{{
										prompt.amountRaw | rai: 'mnano,true' | amountsplit: 0
									}}</span>
									<span class="merchant-mode-amount-fractional">{{
										prompt.amountRaw | rai: 'mnano,true' | amountsplit: 1
									}}</span>
									<span class="merchant-mode-currency-name merchant-mode-currency-margin">XNO</span>
								</p>
								@if (prompt.amountHiddenRaw > 0) {
									<div
										class="uk-text-small text-half-muted block-hash-monospace"
										style="margin: -22px 0 28px 0"
									>
										+{{ prompt.amountHiddenRaw.toString(10) }} raw
									</div>
								}
								@if (prompt.moreThanRequested) {
									<button
										class="uk-width-1-1 uk-button uk-button-primary uk-text-center nlt-icon-button uk-margin-bottom nlt-button-green"
										type="button"
										(click)="merchantModeMarkCompleteFromPrompt(prompt)"
									>
										<span
											class="nlt-icon"
											uk-icon="icon: check;"
											style="margin-top: -2px"
										></span>
										Mark Payment Complete
									</button>
								}
								@if (prompt.lessThanRequested) {
									<button
										class="uk-width-1-1 uk-button uk-button-primary uk-text-center nlt-icon-button uk-margin-bottom"
										type="button"
										(click)="merchantModeSubtractAmountFromPrompt(prompt, promptIdx)"
									>
										<span
											class="nlt-icon"
											uk-icon="icon: pencil;"
											style="margin-top: -2px"
										></span>
										Subtract From Amount
									</button>
								}
								<button
									class="uk-width-1-1 uk-button uk-button-secondary uk-text-danger uk-text-center nlt-icon-button"
									type="button"
									(click)="merchantModeDiscardPrompt(promptIdx)"
								>
									<span
										class="nlt-icon"
										uk-icon="icon: close;"
										style="margin-top: -2px"
									></span>
									Discard As Unrelated
								</button>
							</div>
						</div>
					}
					@if (merchantModePrompts.length === 0) {
						<p class="uk-text-large uk-margin-top text-half-muted">Awaiting payment...</p>
						<button
							class="uk-width-auto uk-button uk-text-center nlt-icon-button"
							[class.uk-button-primary]="!loadingIncomingTxList"
							[class.uk-button-secondary]="loadingIncomingTxList"
							[class.uk-disabled]="loadingIncomingTxList"
							type="button"
							(click)="!loadingIncomingTxList && getReceivable()"
						>
							@if (!loadingIncomingTxList) {
								<span
									class="nlt-icon"
									uk-icon="icon: refresh;"
									style="margin-top: -2px"
								></span>
							}
							@if (loadingIncomingTxList) {
								<span
									class="spinner"
									uk-spinner="ratio: 0.5;"
								></span>
							}
							{{ loadingIncomingTxList ? 'Checking Payment...' : 'Check Payment' }}
						</button>
					}
					<div
						class="merchant-mode-exit uk-flex uk-flex-middle uk-hidden@s"
						style="margin-top: 70px"
						(click)="merchantModeHideQR()"
					>
						<span
							uk-icon="icon: close; ratio: 1.4;"
							class="uk-margin-small-right"
							style="margin-top: 2px"
						></span>
						<span class="label">Cancel Payment</span>
					</div>
				}
				@if (inMerchantModePaymentComplete === true) {
					<p class="uk-text-large uk-margin-remove-bottom uk-text-success">Received</p>
					<p class="uk-text-large uk-text-success uk-margin-remove-top">
						<span class="merchant-mode-amount-integer">{{
							merchantModeRawReceivedTotal | rai: 'mnano,true' | amountsplit: 0
						}}</span>
						<span class="merchant-mode-amount-fractional">{{
							merchantModeRawReceivedTotal | rai: 'mnano,true' | amountsplit: 1
						}}</span>
						<span class="merchant-mode-currency-name merchant-mode-currency-margin">XNO</span>
					</p>
					@if (merchantModeRawReceivedTotalHiddenRaw > 0) {
						<div
							class="uk-text-small text-half-muted block-hash-monospace"
							style="margin: -22px 0 28px 0"
						>
							+{{ merchantModeRawReceivedTotalHiddenRaw.toString(10) }} raw
						</div>
					}
					<img
						style="width: 50%; margin-top: -40px"
						src="data:image/svg+xml,%3Csvg width='200mm' height='200mm' viewBox='0 0 200 200' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='m157.05 40.584c-2.5562-2e-6 -5.1127 0.97964-7.0714 2.9383l-65.687 65.687-34.266-34.266c-3.9174-3.9174-10.225-3.9174-14.142 1e-6l-12.915 12.915c-3.9174 3.9174-3.9174 10.225-1e-6 14.142l39.526 39.526c0.4262 0.72955 0.95143 1.4181 1.5782 2.0448l12.915 12.915c3.9174 3.9174 10.225 3.9174 14.142 0l85.906-85.907c3.9174-3.9174 3.9174-10.224 0-14.142l-12.915-12.915c-1.9587-1.9587-4.5147-2.9383-7.0709-2.9383z' fill='none' stop-color='%23000000' stroke='%2332d296' stroke-linejoin='round' stroke-width='2' style='paint-order:stroke fill markers'/%3E%3C/svg%3E"
					/>
					<p class="uk-flex uk-flex-center uk-flex-middle text-half-muted uk-margin-remove-bottom">
						<button
							class="uk-button uk-button-secondary uk-text-center nlt-icon-button"
							type="button"
							ngxClipboard
							[cbContent]="
								'Amount Requested: ' +
								(merchantModeRawRequestedTotal | rai: 'mnano,true' | amountsplit: 0) +
								(merchantModeRawRequestedTotal | rai: 'mnano,true' | amountsplit: 1) +
								' XNO' +
								'\n\n' +
								'Amount Paid: ' +
								(merchantModeRawReceivedTotal | rai: 'mnano,true' | amountsplit: 0) +
								(merchantModeRawReceivedTotal | rai: 'mnano,true' | amountsplit: 1) +
								' XNO' +
								'\n\n' +
								'Transaction ID\'s:' +
								'\n- ' +
								merchantModeTransactionHashes.join('\n- ')
							"
						>
							<span
								class="nlt-icon"
								uk-icon="icon: copy;"
							></span>
							Copy Payment Information
						</button>
					</p>
					<ul class="uk-width-1-1">
						@for (hash of merchantModeTransactionHashes; track hash) {
							<li
								class="uk-text-left text-half-muted block-hash-monospace"
								style="word-wrap: anywhere"
							>
								{{ hash }}
							</li>
						}
					</ul>
					<div
						class="merchant-mode-exit uk-flex uk-flex-middle"
						style="margin-top: 70px"
						(click)="merchantModeResetState()"
					>
						<span
							uk-icon="icon: plus-circle; ratio: 1.4;"
							class="uk-margin-small-right"
							style="margin-top: 2px"
						></span>
						<span class="label">New Payment</span>
					</div>
				}
			</div>
		</div>
	</div>
</div>

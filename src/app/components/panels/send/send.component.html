<div
	class="uk-animation-slide-left-small"
	uk-grid
>
	<div class="uk-width-1-1">
		<h2 class="uk-heading-divider">
			{{ sendDestinationType === 'own-address' ? 'Transfer Nano Between Own Accounts' : 'Send Nano' }}
		</h2>
		<!-- Send Panel -->
		@if (activePanel == 'send') {
			<div
				uk-grid
				class="uk-animation-slide-left-small"
			>
				<div class="send-types-wrapper uk-width-1-1 uk-text-center">
					<div class="send-types-frame">
						<button
							[class]="[
								'send-types-tab',
								'uk-text-truncate',
								sendDestinationType === 'external-address' ? 'send-types-tab-active' : 'send-types-tab-inactive',
								'uk-button',
								sendDestinationType === 'external-address' ? 'uk-button-primary' : 'uk-button-secondary',
							]"
							type="button"
							(click)="setSendDestinationType('external-address')"
						>
							Send to address
						</button>
						<button
							[class]="[
								'send-types-tab',
								'uk-text-truncate',
								sendDestinationType === 'own-address' ? 'send-types-tab-active' : 'send-types-tab-inactive',
								'uk-button',
								sendDestinationType === 'own-address' ? 'uk-button-primary' : 'uk-button-secondary',
							]"
							type="button"
							(click)="setSendDestinationType('own-address')"
						>
							Transfer between own accounts
						</button>
					</div>
				</div>
				<div class="uk-width-1-1">
					<div class="uk-card uk-card-default">
						<div class="uk-card-body">
							<div class="uk-form">
								<div class="uk-margin">
									<label
										class="uk-form-label"
										for="form-select-from-account"
										>From Account</label
									>
									<div class="uk-form-controls">
										<select
											class="form-select-source uk-select"
											[(ngModel)]="fromAddress"
											(change)="resetAmount()"
											id="form-select-from-account"
										>
											@for (account of svcWallet.accounts(); track account.address) {
												<option [value]="account.address">
													{{ account.addressBookName ? account.addressBookName + ' - ' : '#' + account.index + ' - ' }}
													{{ account.address | squeeze }} (&#xe001;{{
														account?.balance ?? 0 | rai: 'nano,true' | amountsplit: 0
													}}{{ account?.balance ?? 0 | rai: 'nano,true' | amountsplit: 1 }})
												</option>
											}
										</select>
									</div>
								</div>
								@if (sendDestinationType === 'external-address') {
									<div class="uk-margin">
										<label
											class="uk-form-label"
											for="form-text2"
											>To Address</label
										>
										<div class="uk-form-controls">
											<div class="form-input-destination uk-inline uk-width-1-1">
												<a
													class="hide-on-small-viewports uk-form-icon uk-form-icon-flip"
													uk-icon="icon: camera"
													(click)="openQR('account1', 'account')"
													uk-tooltip
													title="Scan from QR code"
												></a>
												<input
													(blur)="validateDestination()"
													(input)="onDestinationAddressInput()"
													(focus)="searchAddressBook()"
													[(ngModel)]="toAddress"
													[ngClass]="{
														'uk-form-success': toAccountStatus === 2,
														'uk-form-danger': toAccountStatus === 0,
													}"
													class="uk-input"
													id="form-text2"
													type="text"
													placeholder="Address to send to / nano:.."
													autocomplete="off"
												/>
												@if ((addressBookResults$ | async).length) {
													<div
														[hidden]="!showAddressBook"
														class="nlt-dropdown uk-animation-slide-down-small uk-width-1-1 uk-card uk-card-default uk-card-body uk-position-absolute"
														style="z-index: 15000"
													>
														<ul class="uk-nav uk-nav-default">
															@if ((addressBookResults$ | async).length) {
																<li class="uk-nav-header">Address Book Results</li>
																<li class="uk-nav-divider"></li>
																@for (book of addressBookResults$ | async; track book) {
																	<li>
																		<a (click)="selectBookEntry(book.account)">{{ book.name }}</a>
																	</li>
																}
															}
														</ul>
													</div>
												}
											</div>
										</div>
										@if (addressBookMatch) {
											<div class="uk-form-controls">
												@if (addressBookMatch) {
													<div class="uk-inline uk-width-auto uk-margin-small-right">
														<span class="account-label blue uk-margin-small-top">{{ addressBookMatch }}</span>
													</div>
												}
											</div>
										}
									</div>
								}
								@if (sendDestinationType === 'own-address') {
									<div class="uk-margin">
										<label
											class="uk-form-label"
											for="form-text2"
											>To Account</label
										>
										<div class="uk-form-controls">
											<select
												required
												class="form-select-destination uk-select"
												[(ngModel)]="toOwnAddress"
												id="form-select-to-own-account"
											>
												<option
													value=""
													disabled
													selected
													hidden
												>
													Account to transfer to
												</option>
												@for (account of svcWallet.accounts(); track account.address) {
													@if (account.address !== fromAddress) {
														<option [value]="account.address">
															{{
																account.addressBookName ? account.addressBookName + ' - ' : '#' + account.index + ' - '
															}}
															{{ account.address | squeeze }} (&#xe001;{{
																account?.balance ?? 0 | rai: 'nano,true' | amountsplit: 0
															}}{{ account?.balance ?? 0 | rai: 'nano,true' | amountsplit: 1 }})
														</option>
													}
												}
											</select>
										</div>
									</div>
								}
								<div class="form-amount uk-form-controls">
									<div uk-grid>
										<!-- Nano amount -->
										<div class="uk-width-1-1">
											<label
												class="uk-form-label"
												for="send-form-input-number-amount-nano"
												>XNO (nano)</label
											>
											<div class="uk-inline uk-width-1-1">
												<label
													class="uk-form-icon uk-link-reset uk-link-muted"
													for="send-form-input-number-amount-nano"
												>
													<span class="xno">&#xE001;</span>
												</label>
												<input
													[formControl]="amounts.nano"
													(input)="syncTo('nano')"
													[ngClass]="{ 'uk-form-danger': amount < 0 }"
													style="padding-left: 52px !important"
													class="uk-input"
													id="send-form-input-number-amount-nano"
													type="text"
													placeholder="XNO (nano)"
													maxlength="40"
												/>
											</div>
										</div>
										<!-- Fiat Amount -->
										<div class="uk-width-1-1">
											<label
												class="uk-form-label"
												for="send-form-input-number-amount-fiat"
												>{{ displayCurrency.toUpperCase() }}</label
											>
											<div class="uk-width-1-1 uk-inline">
												<label
													class="uk-form-icon uk-link-reset uk-link-muted fiat-currency-ticker"
													for="send-form-input-number-amount-fiat"
													>{{ displayCurrency | currencySymbol }}</label
												>
												<input
													[formControl]="amounts.fiat"
													(input)="syncTo('fiat')"
													[ngClass]="{ 'uk-form-danger': amount < 0 }"
													style="padding-left: 52px !important"
													class="uk-input"
													id="send-form-input-number-amount-fiat"
													type="text"
													placeholder="{{ displayCurrency }}"
												/>
											</div>
										</div>
										<!-- Raw amount -->
										<div class="uk-width-1-1">
											<label
												class="uk-form-label"
												for="send-form-input-number-amount-raw"
												>XNO (raw)</label
											>
											<div class="uk-inline uk-width-1-1">
												<a
													class="max-amt-button uk-form-icon uk-form-icon-flip form-icon-btn"
													(click)="setMaxAmount()"
													uk-tooltip
													title="Set Maximum Amount"
													>Max</a
												>
												<label
													class="uk-form-icon uk-link-reset uk-link-muted"
													for="send-form-input-number-amount-raw"
												>
													<span class="xno">&#xE001;</span>
												</label>
												<input
													[formControl]="amounts.raw"
													(input)="syncTo('raw')"
													[ngClass]="{ 'uk-form-danger': amount < 0 }"
													style="padding-left: 52px !important"
													class="uk-input"
													id="send-form-input-number-amount-raw"
													type="text"
													placeholder="XNO (raw)"
													maxlength="40"
												/>
											</div>
										</div>
									</div>
								</div>
							</div>
						</div>
						<div class="uk-card-footer">
							<div class="uk-text-right@s nlt-button-group">
								@if (!preparingTransaction) {
									<button
										class="uk-button uk-button-primary uk-width-1-1@s uk-width-auto@m uk-float-right nlt-icon-button"
										type="button"
										(click)="sendTransaction()"
									>
										{{ sendDestinationType === 'own-address' ? 'Transfer nano' : 'Send nano' }}
									</button>
								}
								@if (preparingTransaction) {
									<button
										class="uk-button uk-button-secondary uk-disabled uk-width-1-1@s uk-width-auto@m uk-float-right nlt-icon-button"
										type="button"
									>
										<span
											class="spinner"
											uk-spinner="ratio: 0.5;"
										></span
										>Preparing transaction
									</button>
								}
								@if (sendDestinationType !== 'own-address') {
									<button
										class="only-on-small-viewports uk-button uk-button-secondary uk-width-1-1@s uk-width-auto@m uk-float-right nlt-icon-button"
										[class.uk-disabled]="preparingTransaction"
										type="button"
										(click)="openQR('account1', 'account')"
									>
										Scan QR code
									</button>
								}
							</div>
						</div>
					</div>
				</div>
			</div>
		}
		<!-- End Send Panel -->
		<!-- Confirmation Panel -->
		@if (activePanel == 'confirm') {
			<div
				uk-grid
				class="uk-animation-slide-left"
			>
				<div class="uk-width-1-1">
					<div
						class="uk-card uk-card-default uk-width-1-1 uk-text-center"
						style="margin-bottom: 20px"
					>
						<div
							class="uk-card-body"
							style="padding: 15px"
						>
							<div class="uk-text-danger">You are about to send</div>
							<div class="block-amount-primary uk-text-danger">
								<span class="amount-integer">{{ amount | rai: 'nano,true' | amountsplit: 0 }}</span>
								<span class="amount-fractional">{{ amount | rai: 'nano,true' | amountsplit: 1 }}</span>
							</div>
							<div class="uk-text-small text-half-muted">
								{{ amount.toString() }}
							</div>
							<div class="text-half-muted">
								{{ amount | fiat }}
							</div>
							<div class="uk-text-muted">Exchange Rate: {{ displayCurrency | currencySymbol }}{{ lastPrice }}</div>
						</div>
					</div>
					@if (fromAccount && toAccount) {
						<div
							class="account-snippet-container"
							style="margin-bottom: 20px"
						>
							<div class="account-snippet uk-text-truncate">
								<div
									class="uk-card uk-card-default uk-text-truncate"
									[class.identicons-enabled]="identiconsStyle !== 'none'"
								>
									<div class="uk-card-header">
										<div class="snippet-caption uk-text-small text-half-muted">From Account</div>
										<div
											class="uk-flex uk-flex-nowrap uk-width-auto uk-text-truncate"
											style="max-width: calc(100% - 35px)"
										>
											<a
												[routerLink]="'/accounts/' + fromAddress"
												class="uk-link-reset account-container uk-text-truncate"
												uk-tooltip
												title="View Account Details"
											>
												<div class="identicon-address-book-row">
													@if (identiconsStyle !== 'none') {
														<app-nano-identicon
															scale="12"
															[address]="fromAddress"
															[settingIdenticonsStyle]="identiconsStyle"
															class="nano-identicon"
														></app-nano-identicon>
													}
													@if (fromAddressBook) {
														<div class="account-label uk-text-truncate">{{ fromAddressBook }}</div>
													}
												</div>
												<div class="nano-address-clickable nano-address-monospace uk-text-truncate">
													<app-nano-address [value]="fromAddress"></app-nano-address>
												</div>
											</a>
											<div class="snippet-address-actions uk-width-auto uk-flex uk-flex-bottom">
												<ul class="uk-iconnav">
													<li>
														<a
															ngxClipboard
															[cbContent]="fromAddress"
															(cbOnSuccess)="copied()"
															uk-icon="icon: copy"
															title="Copy Account Address"
															uk-tooltip
														></a>
													</li>
												</ul>
											</div>
										</div>
									</div>
									<div class="uk-card-body">
										<div uk-grid>
											<div class="uk-width-1-2 uk-text-muted">
												<div
													class="uk-text-small text-half-muted"
													style="height: 25px"
												>
													Current Balance
												</div>
												<span class="block-balance">
													<span class="balance-amount-primary">
														<span class="amount-integer"
															><span class="xno">&#xE001;</span
															>{{ fromAccount.balance || 0 | rai: 'nano,true' | amountsplit: 0 }}</span
														>
														<span class="amount-fractional">{{
															fromAccount.balance || 0 | rai: 'nano,true' | amountsplit: 1
														}}</span>
													</span>
												</span>
											</div>
											<div class="uk-width-1-2 uk-text-right">
												<div
													class="uk-text-small text-half-muted"
													style="height: 25px"
												></div>
												<span class="block-balance">
													<span class="balance-amount-primary uk-text-danger">
														<span class="amount-sign">-</span>
														<span class="amount-integer"
															><span class="xno">&#xE001;</span>{{ amount | rai: 'nano,true' | amountsplit: 0 }}</span
														>
														<span class="amount-fractional">{{ amount | rai: 'nano,true' | amountsplit: 1 }}</span>
													</span>
												</span>
											</div>
										</div>
									</div>
								</div>
							</div>
							<div class="account-snippet uk-text-truncate">
								<div
									class="uk-card uk-card-default uk-text-truncate"
									[class.identicons-enabled]="identiconsStyle !== 'none'"
								>
									<div class="uk-card-header">
										<div class="snippet-caption uk-text-small text-half-muted">To Account</div>
										<div
											class="uk-flex uk-flex-nowrap uk-width-auto uk-text-truncate"
											style="max-width: calc(100% - 35px)"
										>
											<a
												[routerLink]="'/accounts/' + getDestinationAddress()"
												class="uk-link-reset account-container uk-text-truncate"
												uk-tooltip
												title="View Account Details"
											>
												<div class="identicon-address-book-row">
													@if (identiconsStyle !== 'none') {
														<app-nano-identicon
															scale="12"
															[address]="getDestinationAddress()"
															[settingIdenticonsStyle]="identiconsStyle"
															class="nano-identicon"
														></app-nano-identicon>
													}
													@if (toAddressBook) {
														<div class="account-label uk-text-truncate">{{ toAddressBook }}</div>
													}
												</div>
												<div class="nano-address-clickable nano-address-monospace uk-text-truncate">
													<app-nano-address [value]="getDestinationAddress()"></app-nano-address>
												</div>
											</a>
											<div class="snippet-address-actions uk-width-auto uk-flex uk-flex-bottom">
												<ul class="uk-iconnav">
													<li>
														<a
															ngxClipboard
															[cbContent]="getDestinationAddress()"
															(cbOnSuccess)="copied()"
															uk-icon="icon: copy"
															title="Copy Account Address"
															uk-tooltip
														></a>
													</li>
												</ul>
											</div>
										</div>
									</div>
									<div class="uk-card-body">
										<div uk-grid>
											<div class="uk-width-1-2 uk-text-muted">
												<div
													class="uk-text-small text-half-muted"
													style="height: 25px"
												>
													Current Balance
												</div>
												<span class="block-balance">
													<span class="balance-amount-primary">
														<span class="amount-integer"
															><span class="xno">&#xE001;</span
															>{{ toAccount.balance || 0 | rai: 'nano,true' | amountsplit: 0 }}</span
														>
														<span class="amount-fractional">{{
															toAccount.balance || 0 | rai: 'nano,true' | amountsplit: 1
														}}</span>
													</span>
												</span>
											</div>
											<div class="uk-width-1-2 uk-text-right">
												<div
													class="uk-text-small text-half-muted"
													style="height: 25px"
												></div>
												<span class="block-balance">
													<span class="balance-amount-primary uk-text-success">
														<span class="amount-sign">+</span>
														<span class="amount-integer"
															><span class="xno">&#xE001;</span>{{ amount | rai: 'nano,true' | amountsplit: 0 }}</span
														>
														<span class="amount-fractional">{{ amount | rai: 'nano,true' | amountsplit: 1 }}</span>
													</span>
												</span>
											</div>
										</div>
									</div>
								</div>
							</div>
						</div>
					}
					<div class="uk-text-right@s nlt-button-group">
						<button
							(click)="activePanel = 'send'"
							class="uk-button uk-button-danger uk-width-1-1@s uk-width-auto@m"
						>
							Cancel
						</button>
						@if (!confirmingTransaction) {
							<button
								class="uk-button uk-button-primary uk-width-1-1@s uk-width-auto@m"
								(click)="confirmTransaction()"
							>
								Confirm & Send
							</button>
						}
						@if (confirmingTransaction) {
							<button
								class="uk-button uk-button-secondary uk-disabled nlt-icon-button nlt-icon-button-inline uk-width-1-1@s uk-width-auto@m"
							>
								<span
									class="spinner"
									uk-spinner="ratio: 0.5;"
								></span>
								Sending
							</button>
						}
					</div>
				</div>
			</div>
		}
		<!-- End Confirmation Panel -->
	</div>
</div>
